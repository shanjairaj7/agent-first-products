---
import Base from '../layouts/Base.astro';
import { TOOLS, getRegistryMeta } from '../data/registry';
import { RegistryDashboard } from '../components/islands/RegistryDashboard';

const meta = getRegistryMeta();
const base = import.meta.env.BASE_URL.replace(/\/$/, '');

// Stat rows for the hero
const stats = [
  { label: 'Tools', value: meta.total, icon: 'üì¶' },
  { label: 'With MCP', value: meta.interfaceCounts.mcp, icon: 'üîå' },
  { label: 'API Signup', value: TOOLS.filter(t => t.signup.method === 'api').length, icon: '‚ö°' },
  { label: 'Avg Score', value: `${meta.avgScore}/10`, icon: '‚≠ê' },
];
---

<Base>
  <!-- Hero -->
  <section class="border-b border-zinc-800/40">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 pt-12 pb-10">
      <!-- Title -->
      <div class="max-w-2xl">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full border border-indigo-500/25 bg-indigo-500/8 mb-5">
          <span class="w-1.5 h-1.5 rounded-full bg-indigo-400 animate-pulse"></span>
          <span class="text-[11px] font-medium text-indigo-300">Agent First Products Registry</span>
        </div>
        <h1 class="text-3xl sm:text-4xl font-bold text-white leading-tight tracking-tight">
          Tools built natively<br class="hidden sm:block" />
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-400 to-purple-400">
            for AI agents
          </span>
        </h1>
        <p class="mt-3 text-zinc-400 text-base leading-relaxed max-w-xl">
          Every tool scored on how agent-native it is ‚Äî API signup, MCP servers, SDK coverage, and
          whether agents can do everything without a dashboard.
        </p>
      </div>

      <!-- Stats row -->
      <div class="flex flex-wrap gap-4 mt-8">
        {stats.map(s => (
          <div class="flex items-center gap-2.5 px-4 py-2.5 rounded-xl bg-zinc-900 border border-zinc-800">
            <span class="text-lg">{s.icon}</span>
            <div>
              <p class="text-lg font-bold text-white leading-none">{s.value}</p>
              <p class="text-[11px] text-zinc-500 mt-0.5">{s.label}</p>
            </div>
          </div>
        ))}
      </div>

      <!-- CLI hint -->
      <div class="mt-6 flex items-center gap-2 text-[12px] font-mono text-zinc-600">
        <span class="text-zinc-700">$</span>
        <span>curl {base}/api/tools.json | jq '.[] | select(.interfaces.mcp == true) | .name'</span>
      </div>
    </div>
  </section>

  <!-- Registry -->
  <section class="max-w-7xl mx-auto px-4 sm:px-6 py-8">
    <RegistryDashboard tools={TOOLS} base={base} client:load />
  </section>
</Base>
